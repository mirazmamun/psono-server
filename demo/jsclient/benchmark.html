<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Benchmark</title>

    <!-- All of the following lines in head are kinda mandatory -->

    <!-- NaCl, SCrypt and sha512 are mandatory -->
    <script src="libs/js-nacl/lib/nacl_factory.js" type="text/javascript"></script>
    <script src="libs/scrypt/browser/scrypt.js" type="text/javascript"></script>
    <script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/sha512.js" type="text/javascript"></script>
    <script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/core-min.js"></script>
    <script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/enc-base64-min.js"></script>

    <!-- Benchmark JS for benchmarking and the dependencies -->
    <script src="libs/benchmark.js/benchmark.js" type="text/javascript"></script>

    <!-- Main Script -->
    <script src="client.js" type="text/javascript"></script>

    <!-- Jquery is used for all REST-API Calls -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

    <script>
        var nacl = nacl_factory.instantiate();
    </script>
</head>
<body>

    <script>
        function test (title) {

            var div = document.createElement('div');
            var h1 = document.createElement('h1');
            $(h1).append(title);
            $(div).append(h1);
            $('body').append(div);

            this.addLine = function (line) {
                $(div).append(line+'<br>');
            }
        }
    </script>


    <script>


        var delimiter_big = '======================================================';
        var delimiter_small = '===';

        // START NaCl-SHA-512 vs CryptoJS-SHA-512
        var test1 = new test('NaCl-SHA-512 vs CryptoJS-SHA-512');
        var suite = new Benchmark.Suite;

        // add tests
        suite.add('NaCl-SHA-512', function() {
            nacl.to_hex(nacl.crypto_hash_string("sexy"));
        })
        .add('CryptoJS-SHA-512', function() {
            CryptoJS.SHA512("sexy").toString(CryptoJS.enc.Hex);
        })
        // add listeners
        .on('cycle', function(event) {
            test1.addLine(String(event.target));
        })
        .on('complete', function() {
            test1.addLine('Fastest is ' + this.filter('fastest').pluck('name'));
        })
        // run async
        .run({ 'async': true });
        // END NaCl-SHA-512 vs CryptoJS-SHA-512


        // START Public Key encryption vs Secret Key encryption
        var test2 = new test('Public Key encryption vs Secret Key encryption');

        suite = new Benchmark.Suite;

        var senderKeypair = nacl.crypto_box_keypair();
        var recipientKeypair = nacl.crypto_box_keypair();
        var k = nacl.random_bytes(32);

        // add tests
        suite.add('Public Key', function() {
            var message = nacl.encode_utf8("Hello!");

            var nonce = nacl.crypto_box_random_nonce();
            var packet = nacl.crypto_box(message, nonce, recipientKeypair.boxPk, senderKeypair.boxSk);

            var decoded = nacl.crypto_box_open(packet, nonce, senderKeypair.boxPk, recipientKeypair.boxSk);
        })
        .add('Secret Key', function() {
            var m = nacl.encode_utf8("Hello!");
            var n = nacl.crypto_secretbox_random_nonce();
            var c = nacl.crypto_secretbox(m, n, k);
            var m1 = nacl.crypto_secretbox_open(c, n, k);
        })
        // add listeners
        .on('cycle', function(event) {
            test2.addLine(String(event.target));
        })
        .on('complete', function() {
            test2.addLine('Fastest is ' + this.filter('fastest').pluck('name'));
        })
        // run async
        .run({ 'async': true });
        // END Public Key encryption vs Secret Key encryption

    </script>



</body>
</html>
